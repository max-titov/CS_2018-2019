import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.util.ArrayList;

public class BlackjackPlayer extends Player {

	private int totalMoney;
	private int bet;

	// ints that show the most recent transaction (+30)
	private int totalMoneyTransaction;
	private int betTransaction;

	public BlackjackPlayer(String name, int totalMoney, int x, int y) {
		super(name, x, y);
		this.totalMoney = totalMoney;
		this.bet = 0;
	}

	public int getHandValue() { // need case when player has 2 Aces!!!
		int sum1 = 0; // sum with Ace equaling 1
		int sum2 = 0; // sum with Ace equaling 11
		for (Card card : this.getHand()) {
			int faceValue = card.getFaceValue();
			if (faceValue == 1) { // Ace
				sum1 += 1;
				sum2 += 11;
			} else if (faceValue >= 11) { // Jack, Queen, King
				sum1 += 10;
				sum2 += 10;
			} else {
				sum1 += faceValue;
				sum2 += faceValue;
			}
		}
		if (sum2 > 21) { // if sum with Ace equaling 11 is a bust, return the other one
			return sum1;
		} else {
			return sum2;
		}
	}

	public int getTotalMoney() {
		return totalMoney;
	}

	public void setTotalMoney(int totalMoney) {
		this.totalMoney = totalMoney;
	}

	public int getBet() {
		return bet;
	}

	public void setBet(int bet) {
		this.setBetTransaction(bet);
		if (this.getTotalMoney() - bet < 0) {
			this.setBet(this.getTotalMoney());

			this.setTotalMoneyTransaction(-1 * this.getTotalMoney());
			this.setTotalMoney(0);
		} else {
			this.bet = bet;
			this.setTotalMoneyTransaction(-1 * bet);
			this.setTotalMoney(this.getTotalMoney() - bet);
		}
	}

	public int getTotalMoneyTransaction() {
		return totalMoneyTransaction;
	}

	public void setTotalMoneyTransaction(int totalMoneyTransaction) {
		this.totalMoneyTransaction = totalMoneyTransaction;
	}

	public int getBetTransaction() {
		return betTransaction;
	}

	public void setBetTransaction(int betTransaction) {
		this.betTransaction = betTransaction;
	}

	@Override
	public String toString() {
		return getName() + ": " + getHandValue() + " | Cards: " + getHand();
	}

	// graphics

	public void setCardPositions() {
		ArrayList<Card> hand = this.getHand();
		for (int c = 0; c < hand.size(); c++) {// iterates through all cards
			hand.get(c).setX(c * 25 + this.getX());
			hand.get(c).setY(75 + c * 25 + this.getY());
		}
		this.setHand(hand);
	}

	public void display(Graphics g) {
		// name
		g.setColor(Color.BLACK);
		g.setFont(new Font("SansSerif", Font.BOLD, 32));
		g.drawString(this.getName(), this.getX(), this.getY());

		// bet
		g.setColor(Color.BLACK);
		g.setFont(new Font("MonoSpaced", Font.BOLD, 20));
		g.drawString("Bet: " + this.getBet(), this.getX(), this.getY() + 35);

		setTransactionColor(g, betTransaction);
		g.drawString(getTransaction(betTransaction), this.getX() + 30, this.getY() + 35);

		// total money
		g.setColor(Color.BLACK);
		g.drawString("Total: " + this.getTotalMoney(), this.getX(), this.getY() + 60);

		setTransactionColor(g, totalMoneyTransaction);
		g.drawString(getTransaction(totalMoneyTransaction), this.getX() + 30, this.getY() + 60);

		for (Card card : this.getHand())
			card.draw(g);
	}

	private void setTransactionColor(Graphics g, int transaction) {
		if (transaction > 0) { // positive
			g.setColor(Color.GREEN);
		} else if (transaction < 0) { // negative
			g.setColor(Color.RED);
		} else {
			g.setColor(Color.WHITE);
		}
	}

	private String getTransaction(int transaction) { // (+10 or -10)
		String str = "";
		if (transaction > 0) { // positive
			str += "+";
		} else if (transaction < 0) { // negative
			str += "-";
		}
		str += transaction;
		return str;
	}

}
